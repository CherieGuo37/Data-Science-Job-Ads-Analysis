with salaryperhour_cet as
(
select  id,
       replace( left(salary, charindex('a',Salary,1)-1),'$','') as salary_per_hour,
        Salary
		
from data_science_jobs_indeed_usa
where Salary like '%hour%'
)
select id, 
       case 
	   when salary_per_hour like 'from%' then substring (salary,charindex('$',salary)+1,3)
	   else  left(salary_per_hour, charindex('- ',salary_per_hour)) 
	   end as  minimum_per_hour ,
	   case 
	   when salary_per_hour like 'up%' then substring (salary,charindex('$',salary)+1,3)
	   else  right (salary_per_hour, charindex('- ',salary_per_hour)) 
	   end as  maximum_per_hour, 
	   case 
	   when len(salary_per_hour)<=3 then left(salary_per_hour,3)
	   end as fixed_per_hour,
	   salary_per_hour,
	   Salary
	  
from salaryperhour_cet
